#!/bin/bash

## get script path
script_path() {
    SOURCE=${BASH_SOURCE[0]}
    DIR=$(dirname "$SOURCE")
    while [ -h "$SOURCE" ]; do
        SOURCE=$(readlink "$SOURCE")
        [[ $SOURCE != /* ]] && SOURCE="$DIR/$SOURCE"
        DIR=$(cd -P "$(dirname "$SOURCE")" && pwd)
    done
    DIR=$(cd -P "$(dirname "$SOURCE")" && pwd)
    echo $DIR
}

SCRIPT_HOME=$(script_path)
ZZEMACS_ROOT=$(cd $SCRIPT_HOME/.. && pwd)
EMACS_BIN="emacs"
PARAMS="--quick"

$EMACS_BIN $PARAMS \
           --eval "(defvar zzemacs-path \"$ZZEMACS_ROOT\")"  \
           --eval "(load-file \"$ZZEMACS_ROOT/.emacs-gdb\")" \
           --eval "(gud-gdb \"gdb -q --fullname $*\")"
